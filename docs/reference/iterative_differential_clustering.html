<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>iterative_differential_clustering — iterative_differential_clustering • IDclust</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="iterative_differential_clustering — iterative_differential_clustering" />
<meta property="og:description" content="Main function of the IDclust package. Provided a
SingleCellExperiment pre-processed with ChromSCape, will find biologically
relevant clusters by iteratively re-clustering and re-processing clusters.
At each iteration, subclusters having enough significantly enriched features
compared to other subclusters are defined as 'true' subclusters. Others are
assigned to parent clusters. The algorithm will stop when no more 'true'
subclusters are found.
This method ensure that each cluster found in this unsupervised way have
significant biological differences, based on the user defined thresholds." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">IDclust</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.00</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Hackability.html">Hacking IDclust</a>
    </li>
    <li>
      <a href="../articles/scEpigenomics.html">Tutorial for scEpigenomics object (SingleCellExperiment)</a>
    </li>
    <li>
      <a href="../articles/scRNA.html">Tutorial for Seurat object (scRNA)</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/vallotlab/IDclust/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>iterative_differential_clustering</h1>
    <small class="dont-index">Source: <a href='https://github.com/vallotlab/IDclust/blob/master/R/IDclust.R'><code>R/IDclust.R</code></a></small>
    <div class="hidden name"><code>iterative_differential_clustering.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Main function of the IDclust package. Provided a
SingleCellExperiment pre-processed with ChromSCape, will find biologically
relevant clusters by iteratively re-clustering and re-processing clusters.
At each iteration, subclusters having enough significantly enriched features
compared to other subclusters are defined as 'true' subclusters. Others are
assigned to parent clusters. The algorithm will stop when no more 'true'
subclusters are found.</p>
<p>This method ensure that each cluster found in this unsupervised way have
significant biological differences, based on the user defined thresholds.</p>
    </div>

    <pre class="usage"><span class='fu'>iterative_differential_clustering</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>iterative_differential_clustering</span><span class='op'>(</span>
  <span class='va'>object</span>,
  output_dir <span class='op'>=</span> <span class='st'>"./"</span>,
  plotting <span class='op'>=</span> <span class='cn'>TRUE</span>,
  saving <span class='op'>=</span> <span class='cn'>TRUE</span>,
  n_dims <span class='op'>=</span> <span class='fl'>10</span>,
  dim_red <span class='op'>=</span> <span class='st'>"PCA"</span>,
  vizualization_dim_red <span class='op'>=</span> <span class='st'>"UMAP"</span>,
  processing_function <span class='op'>=</span> <span class='va'>processing_ChromSCape</span>,
  quantile.activation <span class='op'>=</span> <span class='fl'>0.7</span>,
  differential_function <span class='op'>=</span> <span class='va'>differential_ChromSCape</span>,
  logFC.th <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span>,
  qval.th <span class='op'>=</span> <span class='fl'>0.01</span>,
  min_frac_cell_assigned <span class='op'>=</span> <span class='fl'>0.1</span>,
  limit <span class='op'>=</span> <span class='fl'>5</span>,
  starting.k <span class='op'>=</span> <span class='fl'>100</span>,
  starting.resolution <span class='op'>=</span> <span class='fl'>0.1</span>,
  resolution <span class='op'>=</span> <span class='fl'>0.8</span>,
  k <span class='op'>=</span> <span class='fl'>50</span>,
  limit_by_proportion <span class='op'>=</span> <span class='cn'>NULL</span>,
  color <span class='op'>=</span> <span class='cn'>NULL</span>,
  nThreads <span class='op'>=</span> <span class='fl'>10</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for Seurat</span>
<span class='fu'>iterative_differential_clustering</span><span class='op'>(</span>
  <span class='va'>object</span>,
  output_dir <span class='op'>=</span> <span class='st'>"./"</span>,
  plotting <span class='op'>=</span> <span class='cn'>TRUE</span>,
  saving <span class='op'>=</span> <span class='cn'>TRUE</span>,
  n_dims <span class='op'>=</span> <span class='fl'>50</span>,
  dim_red <span class='op'>=</span> <span class='st'>"pca"</span>,
  vizualization_dim_red <span class='op'>=</span> <span class='st'>"umap"</span>,
  processing_function <span class='op'>=</span> <span class='va'>processing_Seurat</span>,
  differential_function <span class='op'>=</span> <span class='va'>differential_edgeR_pseudobulk_LRT</span>,
  logFC.th <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log2</a></span><span class='op'>(</span><span class='fl'>1.5</span><span class='op'>)</span>,
  qval.th <span class='op'>=</span> <span class='fl'>0.01</span>,
  min_frac_cell_assigned <span class='op'>=</span> <span class='fl'>0.1</span>,
  limit <span class='op'>=</span> <span class='fl'>10</span>,
  starting.resolution <span class='op'>=</span> <span class='fl'>0.1</span>,
  starting.k <span class='op'>=</span> <span class='fl'>100</span>,
  resolution <span class='op'>=</span> <span class='fl'>0.8</span>,
  k <span class='op'>=</span> <span class='fl'>100</span>,
  color <span class='op'>=</span> <span class='cn'>NULL</span>,
  nThreads <span class='op'>=</span> <span class='fl'>10</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A Seurat object preprocessed with Seurat.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters passed to the differential_function. See
<code><a href='differential_edgeR_pseudobulk_LRT.html'>differential_edgeR_pseudobulk_LRT()</a></code> for more information on additional
parameters for the default function.</p></td>
    </tr>
    <tr>
      <th>output_dir</th>
      <td><p>The output directory in which to plot and save objects.</p></td>
    </tr>
    <tr>
      <th>plotting</th>
      <td><p>A logical specifying wether to save the plots or not.</p></td>
    </tr>
    <tr>
      <th>saving</th>
      <td><p>A logical specifying wether to save the data or not.</p></td>
    </tr>
    <tr>
      <th>n_dims</th>
      <td><p>An integer specifying the number of first dimensions to keep
in the dimensionality reduction step.</p></td>
    </tr>
    <tr>
      <th>dim_red</th>
      <td><p>The name of the slot to save the dimensionality reduction at
each step in the  <code>Seurat::Reductions(object)</code>.</p></td>
    </tr>
    <tr>
      <th>vizualization_dim_red</th>
      <td><p>The name of the slot used for plotting. Must be
a valid slot present in <code>Seurat::Reductions(object)</code>.</p></td>
    </tr>
    <tr>
      <th>processing_function</th>
      <td><p>A function that re-process the subset of clusters
at each step. It msut take in entry a Seurat object, <code>dim_red</code>
and <code>n_dims</code> parameters and returns a Seurat containing a cell
embedding. See <a href='processing_Seurat.html'>processing_Seurat</a> for the default function.</p></td>
    </tr>
    <tr>
      <th>quantile.activation</th>
      <td><p>A numeric between 0 and 1 specifying the quantile
of global activation to take as minimal percentage of activation for the
differential analysis. Increasing this value will decrease the number of
differential features.</p></td>
    </tr>
    <tr>
      <th>differential_function</th>
      <td><p>A function that take in entry a
SingleCellExperiment object and  parameters passed in ... and returns a
data.frame containing the significantly differential features for each
cluster. See <a href='differential_edgeR_pseudobulk_LRT.html'>differential_edgeR_pseudobulk_LRT</a> for the default function.</p></td>
    </tr>
    <tr>
      <th>logFC.th</th>
      <td><p>A numeric specifying the log2 fold change of activation
above/below which a feature is considered as significantly differential
passed to the differential_function.</p></td>
    </tr>
    <tr>
      <th>qval.th</th>
      <td><p>A numeric specifying the adjusted p-value below
which a feature is considered as significantly differential passed to the
differential_function.</p></td>
    </tr>
    <tr>
      <th>min_frac_cell_assigned</th>
      <td><p>A numeric between 0 and 1 specifying the
minimum percentage of the total cells in the SingleCellExperiment object that
needs to be assigned. If a lower proportion is assigned, all cells are
assigned to the cluster of origin.</p></td>
    </tr>
    <tr>
      <th>limit</th>
      <td><p>An integer specifying the minimum number of significantly
enriched / depleted features required in order for a subcluster to be called
a 'true' subcluster</p></td>
    </tr>
    <tr>
      <th>starting.k</th>
      <td><p>An integer specifying the number of nearest neighbors to
use for  the Louvain clustering of the first iteration. It is recommended
to set it quite high in order to have few starting clusters</p></td>
    </tr>
    <tr>
      <th>starting.resolution</th>
      <td><p>A numeric specifying the resolution to use for the
Louvain clustering of the first iteration. It is recommended to set it quite
low in order to have few starting clusters.</p></td>
    </tr>
    <tr>
      <th>resolution</th>
      <td><p>A numeric specifying the resolution to use for the Louvain
clustering at each iteration.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>An integer specifying the number of nearest neighbors to use for
the Louvain clustering at each iteration.</p></td>
    </tr>
    <tr>
      <th>limit_by_proportion</th>
      <td><p>Optional. A data.frame containing 3 columns -
ncells, mean_n_differential, sd_n_differential - that reflect the number of
false positive expected for a given cluster size.</p></td>
    </tr>
    <tr>
      <th>color</th>
      <td><p>Set of colors to use for the coloring of the clusters. This must
contains enough colors for each cluster (minimum 20 colors, but 100 colors
at least is recommended, based on the dataset).</p></td>
    </tr>
    <tr>
      <th>nThreads</th>
      <td><p>An integer specifying of threads to use
for the calculation of the FDR.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical specifying wether to print.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    


<p>The SingleCellExperiment object with the assignation of cells to clusters.
If saving is true, also saves list of differential analyses, differential
analyses summaries and embeddings for each re-clustered cluster. If runFDR is
TRUE, also saves the list of FDR for each re-clusterd cluster.</p>
<p>The Seurat object with the assignation of cells to clusters.
If saving is true, also saves list of differential analyses, differential
analyses summaries and embeddings for each re-clustered cluster.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The default differential analysis used is the
<code><a href='https://rdrr.io/pkg/ChromSCape/man/differential_activation.html'>ChromSCape::differential_activation()</a></code> function. This function
compares the % of active cells in the cluster versus the rest of cells and
perform a Chi-squared test to calculate p-values.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># Clustering of Seurat scRNA object (Paired-Tag)</span>
<span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"Seurat"</span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"Seu"</span>, package <span class='op'>=</span> <span class='st'>"IDclust"</span><span class='op'>)</span>
<span class='va'>Seu</span> <span class='op'>=</span> <span class='fu'>iterative_differential_clustering</span><span class='op'>(</span><span class='va'>Seu</span>, saving <span class='op'>=</span> <span class='cn'>FALSE</span>, plotting <span class='op'>=</span><span class='cn'>FALSE</span>,
logFC.th <span class='op'>=</span> <span class='fl'>0.2</span>, qval.th <span class='op'>=</span> <span class='fl'>0.1</span><span class='op'>)</span>

<span class='op'>}</span>

<span class='co'># Clustering of scExp scH3K27ac object (Paired-Tag)</span>
<span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"ChromSCape"</span>, quietly<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>

<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"scExp"</span>, package <span class='op'>=</span> <span class='st'>"IDclust"</span><span class='op'>)</span>
<span class='va'>scExp</span> <span class='op'>=</span> <span class='fu'>iterative_differential_clustering</span><span class='op'>(</span><span class='va'>scExp</span>,  saving <span class='op'>=</span> <span class='cn'>FALSE</span>, plotting <span class='op'>=</span><span class='cn'>FALSE</span>,
logFC.th <span class='op'>=</span> <span class='fl'>0.5</span>, qval.th <span class='op'>=</span> <span class='fl'>0.01</span><span class='op'>)</span>

<span class='op'>}</span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Pacome Prompsy, Celine Vallot.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


